cmake_minimum_required(VERSION 3.15)
include(ExternalProject)

project("${CWE_CHECKER_COMPONENT_NAME}_Setup_Project" NONE)

ExternalProject_Add(
        CweCheckerSetupLib
        PREFIX                             "${CWE_CHECKER_HOME_PATH}"
        TMP_DIR                            "${CWE_CHECKER_HOME_PATH}/tmp"
        STAMP_DIR                          "${CWE_CHECKER_HOME_PATH}/stamp"
        DOWNLOAD_DIR                       "${CWE_CHECKER_HOME_PATH}/${CWE_CHECKER_SRC_DIR}"
        GIT_REPOSITORY                     "https://github.com/fkie-cad/cwe_checker"
        GIT_TAG                            "master"
        CONFIGURE_COMMAND                  ""
        SOURCE_DIR                         "${CWE_CHECKER_HOME_PATH}/${CWE_CHECKER_SRC_DIR}"
        BINARY_DIR                         "${CWE_CHECKER_HOME_PATH}/${CWE_CHECKER_SRC_DIR}"
        PATCH_COMMAND                      git apply ${PATCH_FILE}
        BUILD_COMMAND                      make all GHIDRA_PATH=${PATH_TO_GHIDRA} TARGET_DIR=${CWE_CHECKER_BUILD_PATH}
        INSTALL_COMMAND                    ""
        LOG_CONFIGURE                      1
        LOG_BUILD                          0
        LOG_INSTALL                        1
        LOG_TEST                           0)
