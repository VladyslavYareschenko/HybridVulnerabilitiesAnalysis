cmake_minimum_required(VERSION 3.15)
include(ExternalProject)

project("${CWE_CHECKER_COMPONENT_NAME}_Setup_Project" NONE)

ExternalProject_Add(
        CweCheckerSetupLib
        PREFIX                             "${CWE_CHECKER_HOME_PATH}"
        TMP_DIR                            "${CWE_CHECKER_HOME_PATH}/tmp"
        STAMP_DIR                          "${CWE_CHECKER_HOME_PATH}/stamp"
        DOWNLOAD_DIR                       "${CWE_CHECKER_HOME_PATH}/${CWE_CHECKER_SRC_DIR}"
        GIT_REPOSITORY                     "https://github.com/VladyslavYareschenko/cwe_checker"
        GIT_TAG                            "master"
        CONFIGURE_COMMAND                  ""
        SOURCE_DIR                         "${CWE_CHECKER_HOME_PATH}/${CWE_CHECKER_SRC_DIR}"
        BINARY_DIR                         "${CWE_CHECKER_HOME_PATH}/${CWE_CHECKER_SRC_DIR}"
        BUILD_COMMAND                      cargo build --release --lib --target-dir=${CWE_CHECKER_BUILD_PATH}
        INSTALL_COMMAND                    ""
        TEST_BEFORE_INSTALL                ON
        TEST_COMMAND                       cargo test --release
        LOG_CONFIGURE                      1
        LOG_BUILD                          0
        LOG_INSTALL                        1
        LOG_TEST                           0)
